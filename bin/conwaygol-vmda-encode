#!/bin/sh

LANG=C

pname="$(basename "$0")"
stime="$(date +%Y%m%d%H%M%S)"
tmp="/tmp/$pname.$stime.$$"

trap 'rm -f $tmp-*' EXIT

######################################################################

pattern=${1:-"-"}

X=${2:-"10"}
Y=${3:-"10"}

dX=${4:-"0"}
dY=${5:-"0"}

######################################################################

cat "${pattern}"		|
# trancelator
    tr	' _X'	\
	'009'			|
    #
    ## convert cell pattern into vMDA(Vertical Multi-Dimensional Array) format
    sed -e 's/./& /g'		|
    awk -v X="$X" -v Y="$Y" -v dX="$dX" -v dY="$dY"	'
	{	for(i = 1;i <= NF;i++)	if($(i)!="0")
			printf("2 %d %d %d %d %d\n", X, Y, i+dX, NR+dY, $(i))
	}'

######################################################################
exit 0
